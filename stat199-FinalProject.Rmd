---
title: "Final Project Draft - STA 199"
subtitle: "due Thursday, Oct 29 at 11:59p"
author: "Ten Out of Ten: Arushi Bhatia, Luke Vermeer, Kevin Wang, Lauren May"
output: pdf_document
---

```{r installingPackages, echo=FALSE, warning=FALSE, message=FALSE}
r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"
options(repos = r)

# install.packages("viridis")
# install.packages("stopwords")
# install.packages("tidyverse")
# install.packages("tidytext")
# install.packages("wordcloud")
# install.packages("sentimentr")
# install.packages("lubridate")
library(viridis)
library(stopwords)
library(tidyverse)
library(tidytext)
library(wordcloud)
library(sentimentr)
library(lubridate)
```

## Introduction and Data

### Background and Motivation
Relative to other forms of media, social media plays a much greater role in how 
people consume news in today’s technology-driven society. A study conducted in 
2016 by Pew Research points out how 62% of people get news on social media 
(Gottfried & Shearer, 2016). As a result, social media plays an integral role in 
politics, as the presence of a specific subset of information on a user’s feed 
can influence the way they categorize and see the world around them. With more 
and more individuals on social media such as Twitter, the role that this 
platform can play is significantly greater than before. 

Social media, and Twitter in particular, have become an increasingly large 
part of the political landscape in the wake of Donald Trump's 2016 election. 
Trump has been active on Twitter prior to and during his presidency and uses 
the platform as a tool to communicate with his constituency in real time, 
posting updates about policy, campaigning, and his feelings on everything 
from members of Congress to celebrities. He is one of the first politicians 
to use social media this frequently and has personally referred to his use of 
Twitter as “modern day presidential” (Trump, 2017). 

Donald Trump’s Twitter also has “unpresidented” reach among the American public, 
boasting a follower base of over 87 million. This makes him the second 
most-followed political personality and sixth most-followed overall account on 
Twitter (Wikipedia, 2020). On top of this, Trump’s Twitter also receives 
significant attention in the media. Over 850,000 news articles have referenced 
his Twitter use since 2016 and 31% of his Tweets since then have received 
individual media coverage (Real Clear Politics, 2019).

### Research Questions
Because Trump uses Twitter to convey his political agendas in short blurbs, 
analyzing his Tweets can give a unique insight into the way that he thinks. 
Of principal interest were the following research question: 1) How does 
Donald Trump’s sentiment in his Tweets vary across people? and 2) How does 
Donald Trump’s sentiment in his Tweets vary across “hot topics?”

To answer these questions, our team obtained a dataset of Donald Trump’s 
Tweets (n = 53,697). In order to assess how his sentiment varies across 
people and various hot topics, we created indicator variables for different 
people and topics to indicate that a Tweet referenced a specific person/topic. 
We then used the sentimentr package to calculate the overall sentiment of each 
Tweet using the sentiment_by() function. Using the indicator variables, we were 
then able to distinguish the Tweets into discernable categories, allowing us to 
conduct hypothesis tests and create interesting visualizations.

Our hypothesis regarding our research questions is that Trump’s Tweets about
individuals in his "outgroup" have a greater proportion of Tweets
with a negative sentiment. Similarly, we hypothesize that his Tweets about
individuals in his "ingroup" will have a greater proportion of Tweets
with a positive sentiment. We will define ingroup and outgroup in different
ways, and evalate it from different perspectives as well.

### Our Data
The data set was extracted from a website - TrumpTwitterArchive.com. The original 
curator of the data created their own Twitter scraper in order to obtain the 
data. They utilized Python, Selenium (which is a software suite that allows the 
automation of tests utilizing web browsers), and Tweepy (a Python library for 
accessing the Twitter API). Since Twitter makes it challenging to scrape all of 
a user’s Tweets in one go, the way to get around this is to individually search 
for a specific day and extract all the Tweets from that user on that specific 
day. To do this manually would take ages, but the scraper that the curator 
built allows for automated accessing for any desired day and also a range of 
days. The scraper then obtains the Tweet ID, which contains all of the metadata 
of the Tweet, and then uses the metadata to obtain all the other information 
about the Tweet (such as the text, timestamp, number of favorites, etc.). This 
other information is then compiled into a data set, which is made available to 
the public. This data set is updated every minute, which also means that deleted 
Tweets would most likely also appear in this data set. 

This data set includes 53,697 observations. Each individual observation is one 
of President Donald Trump’s Tweets. The original data set contains 7 variables: 
source, text, created_at, reTweet_count, favorite_count, is_reTweeted, id_str. 
The descriptions of each of the original variables is given below. 

- source: Original source where Tweet was posted 

- text: text of the Tweet 

- created_at: Date and time the Tweet was posted/created, provides context

- reTweet_count: number of reTweets 

- favorite_count: number of favorites 

- is_reTweeted: whether or not the Tweet was originally posted on a different 
account and Trump reTweeted 

- id_str: The scrape.py script collects Tweet ids. If you know a Tweet's ID 
number, you can get all the information available about that Tweet using Tweepy 

#### Setting Up Our Data

Our first step in analyzing the relationships between subject and sentiment of 
President Donald Trump’s Tweets was to manipulate the data set, creating some 
new variables that we could use for analysis. We started by creating a set of 
identifier variables for different people that his Tweets might be about. These 
variables were created using multiple mutate commands to set them as either 1
or 0, 1 if the person or topic was mentioned in a Tweet, and 0 if they weren’t. 

We created these variables for a total of 11 relevant political figures: 
Barack Obama, Joe Biden, Hillary Clinton, Alexandria Ocasio-Cortez, Nancy 
Pelosi, Kamala Harris, Mike Pence, Mitch McConnell, Amy Coney Barrett, and Nikki 
Haley. For each of the person identifier variables, we searched for people’s 
full names, their Twitter handles, and commonly-used nicknames to determine 
whether or not a particular Tweet was about them. 

We also repeated the same process to create topical identifier variables for a 
range of subjects that are prevalent in the nation’s political discourse. The 
topics were as follows: COVID-19, climate change, abortion, the Black Lives 
Matter movement, guns, news, immigration, Russia, and the United States. For 
each topic we searched for the name of the thing outright (such as “BLM” or 
“climate change”), as well as words and phrases that are commonly used in 
conjunction with these topics. For example, Tweets that mentioned ICE or the 
term “border wall” were categorized under immigration, and Tweets about CNN, 
FOX News and “media” all went under the “news” topic. 

Next, using the pivot command in R, we were able to create a variable called 
“person,”  and manipulate our original data set into a data set that allowed us
to count Tweets that had multiple people mentioned as an observation that
counted towards both/all of the mentioned people, as it was a categorical 
variable that told us which of the identifier variables for people were equal 
to “1” for each Tweet. As a result, some of the Tweets were the same in this
new pivoted data set, but it allowed us to do our analysis in a much more 
effective and representative manner.

From the new “person” variable, we created two new variables called party and 
gender. The party variable separated the 11 people we were looking at into 
either Democrats or Republicans and assigned Tweets about them to the 
appropriate party category. We did the same for the gender of each of these 
11 people, and added another "gender" variable categorizing the Tweet as 
either about a "male" or "female." 

We did a similar pivoting process for the topic variables as well.

Next, we used the package sentimentr to identify the sentiment of each of 
Trump’s Tweets. For each Tweet, we created a new variable called ave_sentiment 
that contained the raw, numeric sentiment score of the text. This sentiment
score was calculated using the sentiment_by() function. The function finds the 
mean sentiment score of the entire Tweet by averaging the individual sentiment
scores of the words in the Tweet. We then used the mutate command to create a 
new variable called posNeg that grouped sentiment scores into three categories: 
positive, neutral, or negative. Finally, we used the separate command in r to 
break up the variable “created_at” into two separate variables for date and 
time. After this, each observation had a date variable in the mm/dd/yy format 
and a time variable in the 24-hour time format. After these manipulations, the 
data set contained the following variables:

- source: the version of Twitter used to share the Tweet. For example “Twitter 
for iPhone.”

- text: the full text of the Tweet.

- created_at: gives the date (in mm/dd/yy format) and time (in 24-hour format) 
at which the Tweet was published.

- reTweet_count: number of reTweets that the Tweet received.

- favorite_count: number of favorites that the Tweet received.

- is_reTweet: assigns a value of either true or false for whether the Tweet is 
originally written by Trump or is a reTweet of someone else.

- id_str: The scrape.py script collects Tweet ids. If you know a Tweet's id 
you can get all the information available about that Tweet using Tweepy - text, 
timestamp, number of reTweets / replies / favorites, geolocation, etc. 

- obama: 1 or 0 for whether the Tweet talks about Barack Obama.

- biden: 1 or 0 for whether the Tweet talks about Joe Biden.

- pelosi: 1 or 0 for whether the Tweet talks about Nancy Pelosi.

- kamala: 1 or 0 for whether the Tweet talks about Kamala Harris.

- hillary: 1 or 0 for whether the Tweet talks about Hillary Clinton.

- aoc: 1 or 0 for whether the Tweet talks about Alexandria Ocasio-Cortez.

- pence: 1 or 0 for whether the Tweet talks about Mike Pence.

- mcconnell: 1 or 0 for whether the Tweet talks about Mitch McConnell.

- fauci: 1 or 0 for whether the Tweet talks about Dr.  Anthony Fauci.

- amy: 1 or 0 for whether the Tweet talks about Amy Coney Barrett.

- nikki: 1 or 0 for whether the Tweet talks about Nikki Haley.

- covid: 1 or 0 for whether the Tweet talks about COVID-19.

- climateChange: 1 or 0 for whether the Tweet talks about climate change.

- abortion: 1 or 0 for whether the Tweet talks about abortion.

- blm: 1 or 0 for whether the Tweet talks about the Black Lives Matter movement.

- guns: 1 or 0 for whether the Tweet talks about guns.

- news: 1 or 0 for whether the Tweet talks about news media.

- usa: 1 or 0 for whether the Tweet talks about the United States.

- russia: 1 or 0 for whether the Tweet talks about Russia.

- immigration: 1 or 0 for whether the Tweet talks about immigration.

- person: categorical variable for the name of the person that the Tweet is 
about (from among the 11 looked at in this analysis).

- party: political party of the person who is talked about in the Tweet 
(either democrat or republican).

- gender: gender of the person who is talked about in the Tweet (either male or 
female).

- ave_sentiment: numeric sentiment score of the Tweet.

- posNeg: categorical sentiment of the Tweet (either positive, neutral or 
negative).

- date: date that the Tweet was posted (mm/dd/yy).

- time: time that the Tweet was posted (24-hour format).

## Methodology 
The main variables in the data set that we used to address our research
questions were the following:

- text: the full text of the Tweet.

- obama: 1 or 0 for whether the Tweet talks about Barack Obama.

- biden: 1 or 0 for whether the Tweet talks about Joe Biden.

- pelosi: 1 or 0 for whether the Tweet talks about Nancy Pelosi.

- kamala: 1 or 0 for whether the Tweet talks about Kamala Harris.

- hillary: 1 or 0 for whether the Tweet talks about Hillary Clinton.

- aoc: 1 or 0 for whether the Tweet talks about Alexandria Ocasio-Cortez.

- pence: 1 or 0 for whether the Tweet talks about Mike Pence.

- mcconnell: 1 or 0 for whether the Tweet talks about Mitch McConnell.

- fauci: 1 or 0 for whether the Tweet talks about Dr.  Anthony Fauci.

- amy: 1 or 0 for whether the Tweet talks about Amy Coney Barrett.

- nikki: 1 or 0 for whether the Tweet talks about Nikki Haley.

- covid: 1 or 0 for whether the Tweet talks about COVID-19.

- climateChange: 1 or 0 for whether the Tweet talks about climate change.

- abortion: 1 or 0 for whether the Tweet talks about abortion.

- blm: 1 or 0 for whether the Tweet talks about the Black Lives Matter movement.

- guns: 1 or 0 for whether the Tweet talks about guns.

- news: 1 or 0 for whether the Tweet talks about news media.

- usa: 1 or 0 for whether the Tweet talks about the United States.

- russia: 1 or 0 for whether the Tweet talks about Russia.

- immigration: 1 or 0 for whether the Tweet talks about immigration.

- person: categorical variable for the name of the person that the Tweet is 
about (from among the 11 looked at in this analysis).

- party: political party of the person who is talked about in the Tweet 
(either democrat or republican).

- gender: gender of the person who is talked about in the Tweet (either male or 
female).

- ave_sentiment: numeric sentiment score of the Tweet.

- posNeg: categorical sentiment of the Tweet (either positive, neutral or 
negative).

- date: date that the Tweet was posted (mm/dd/yy).

- time: time that the Tweet was posted (24-hour format).

```{r people, echo=FALSE, warning=FALSE, message=FALSE}
trumpTweets <- read_csv("data/trumpTweetCSV.csv") 
trumpTweets <- trumpTweets %>%  
   mutate(obama = case_when((grepl("Obama", text , ignore.case = TRUE) | 
                              grepl("Barack", text , ignore.case = TRUE)) & 
                            !(grepl("Michelle", text , ignore.case = TRUE))~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(biden = case_when((grepl("Biden", text , ignore.case = TRUE) | 
                              grepl("Joe", text , ignore.case = TRUE)) ~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(pelosi = case_when((grepl("Pelosi", text , ignore.case = TRUE) | 
                              grepl("Nancy", text , ignore.case = TRUE)) &
                            ! grepl("@NancyMace", text, ignore.case = TRUE)~ 1,
                            TRUE ~0))


trumpTweets <- trumpTweets %>%  
   mutate(kamala = case_when((grepl("Kamala", text , ignore.case = TRUE))~ 1,
                            TRUE ~0))


trumpTweets <- trumpTweets %>%  
   mutate(hillary = case_when((grepl("Hillary", text , ignore.case = TRUE) | 
                              grepl("Clinton", text , ignore.case = TRUE)) & 
                        !(grepl("Bill Clinton", text , ignore.case = TRUE))~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(aoc = case_when((grepl("AOC", text , ignore.case = TRUE) | 
                              grepl("Ocasio", text , ignore.case = TRUE) |
                            grepl("Cortez", text , ignore.case = TRUE)|
                             grepl("Alexandria", text , ignore.case = TRUE))~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(pence = case_when((grepl("Pence", text , ignore.case = TRUE)) ~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(nikki = case_when((grepl("Nikki Haley", text , ignore.case = TRUE)| 
                              grepl("Nikki", text , ignore.case = TRUE)) ~ 1,
                            TRUE ~0))


trumpTweets <- trumpTweets %>%  
  mutate(mcconnell = case_when(((grepl("McConnell", text , ignore.case = TRUE) | 
                              grepl("Mitch", text , ignore.case = TRUE) |
                            grepl("@Team_Mitch", text , ignore.case = TRUE)) &
                        ! grepl("@mitchellvii", text , ignore.case = TRUE))~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(fauci = case_when((grepl("Fauci", text , ignore.case = TRUE)) ~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(amy = case_when((grepl("Coney Barrett", text , ignore.case = TRUE) | 
                             grepl("ACB", text , ignore.case = TRUE)| 
                             grepl("Judge Amy", text , ignore.case = TRUE)) ~ 1,
                            TRUE ~0))
```


```{r topics, echo=FALSE, warning=FALSE, message=FALSE}
trumpTweets <- trumpTweets %>%  
   mutate(covid = case_when((grepl("COVID", text , ignore.case = TRUE) | 
                              grepl("Corona", text , ignore.case = TRUE) |
                      grepl("Chinese virus", text , ignore.case = TRUE) |
                        grepl("China virus", text , ignore.case = TRUE) |
                        grepl("Chinese plague", text, ignore.case = TRUE) |
                        grepl("Wuhan virus", text , ignore.case = TRUE) |
                        grepl("Kung flu", text , ignore.case = TRUE)|
                        grepl("cdc", text , ignore.case = TRUE)|
                        grepl("fauci", text , ignore.case = TRUE)) ~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(climateChange = case_when((grepl("Climate change", text , 
                                           ignore.case = TRUE) | 
                          grepl("Global warming", text , ignore.case = TRUE) |
                      grepl("Environment", text , ignore.case = TRUE) |
                grepl("Paris Accord", text , ignore.case = TRUE) |
                 grepl("Paris Climate Agreement", text, ignore.case = TRUE) |
                      grepl("Pollute", text , ignore.case = TRUE) |
                      grepl("Pollution", text , ignore.case = TRUE)|
                      grepl("Greta Thunberg", text, ignore.case = TRUE)|
                      grepl("Greta", text, ignore.case = TRUE)) ~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(abortion = case_when((grepl("Abortion", text , ignore.case = TRUE) | 
                        grepl("Planned parenthood", text , ignore.case = TRUE) |
                      grepl("Abort", text , ignore.case = TRUE) |
                        grepl("pro-life", text , ignore.case = TRUE) |
                        grepl("pro-choice", text , ignore.case = TRUE)) ~ 1,
                            TRUE ~0))


trumpTweets <- trumpTweets %>%  
   mutate(blm = case_when((grepl("BLM", text , ignore.case = TRUE) | 
                       grepl("Black lives matter", text , ignore.case = TRUE) |
                      grepl("loot", text , ignore.case = TRUE) |
                        grepl("riot", text , ignore.case = TRUE)) ~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(guns = case_when((grepl("NRA", text , ignore.case = TRUE) | 
                          grepl("Second amendment", text , ignore.case = TRUE) |
                      grepl("gun", text , ignore.case = TRUE) |
                        grepl("bear arms", text , ignore.case = TRUE) |
                        grepl("rifle", text , ignore.case = TRUE) ) ~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(news = case_when((grepl("news", text , ignore.case = TRUE) |
                      grepl("CNN", text , ignore.case = TRUE) |
                        grepl("Fox", text , ignore.case = TRUE) |
                        grepl("media", text , ignore.case = TRUE)) ~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(usa = case_when((grepl("usa", text , ignore.case = TRUE) | 
                              grepl("america", text , ignore.case = TRUE) |
                      grepl("united states", text , ignore.case = TRUE) |
                        grepl("our country", text , ignore.case = TRUE)) ~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(russia = case_when((grepl("russia", text , ignore.case = TRUE) | 
                              grepl("putin", text , ignore.case = TRUE)| 
                            grepl("communism", text , ignore.case = TRUE)) ~ 1,
                            TRUE ~0))

trumpTweets <- trumpTweets %>%  
   mutate(immigration = case_when((grepl("immigrants", text , 
                                         ignore.case = TRUE) | 
                              grepl("immigration", text , ignore.case = TRUE) |
                      grepl("foreigner", text , ignore.case = TRUE) |
                        grepl("open border", text , ignore.case = TRUE) |
                        grepl("the wall", text , ignore.case = TRUE) |
                        grepl("border wall", text , ignore.case = TRUE)|
                        grepl("Mexicans", text , ignore.case = TRUE)|
                        grepl("refugees", text , ignore.case = TRUE)|
                        grepl("ice", text , ignore.case = TRUE)|
                        grepl("border patrol", text , ignore.case = TRUE)|
                        grepl("cages", text , ignore.case = TRUE)) ~ 1,
                            TRUE ~0))


trumpTweets$element_id <- 1:nrow(trumpTweets) 
```


```{r creatingSentimentDataset, echo=FALSE, warning=FALSE, message=FALSE}
trumpTweetsSentiment <- sentiment_by(trumpTweets$text)
TweetsWithSentiment <- left_join(trumpTweets, trumpTweetsSentiment, 
                                 by = "element_id")

TweetsWithSentiment <- TweetsWithSentiment %>% 
   mutate(posNeg = case_when(ave_sentiment> 0 ~ "positive", 
                             ave_sentiment< 0 ~ "negative", 
                             ave_sentiment==0 ~ "neutral"))

TweetsWithSentimentWithoutLink <- TweetsWithSentiment %>% 
  filter(!grepl("^https*", text))
view(TweetsWithSentimentWithoutLink)
```
```{r wordCloud, echo=FALSE, warning=FALSE, message=FALSE}
justWords <- TweetsWithSentimentWithoutLink %>%
  unnest_tokens(word, text)

freqWords <- justWords %>%
  anti_join(get_stopwords(source = "smart"))  %>%
  count(word) %>%
  arrange(desc(n)) %>% 
   filter(!(word=="t.co" | word=="realdonaldtrump"| word=="https" | word=="rt"| 
      word=="amp" | word=="http" | word =="10" | word=="2015" | word=="2016"))
wordCloud <- freqWords %>% with(wordcloud(word, n, max.words = 100))
```

Figure 1: Word cloud of the top 100 words Donald Trump uses in his Tweets. Some
of the words that were not part of the actual text of the Tweet or were
artifacts of Tweets (such as URLs, account names, and years) were removed to 
clean the data.

```{r wordFreqGraph, echo=FALSE, warning=FALSE, message=FALSE}
freqChart <- freqWords %>%
  top_n(20) %>%
  ggplot(aes(fct_reorder(word, n), n)) +
    geom_col() +
    coord_flip() + 
    theme_minimal() +
    labs(title = "Frequency of words in Donald Trump's Tweets",
         subtitle = "Top 20 word displayed",
         y = "Frequency",
         x = "Words")

freqChart
```

Figure 2: Frequency of Donald Trump's top 20 words that are used in his Tweets.
Just like in Figure 1, some of the words that were not part of the actual text 
of the Tweet or were artifacts of Tweets (such as URLs, account names, and 
years) were removed to clean the data.

```{r creatingNewDataFrameWithPeople, echo=FALSE, warning=FALSE, message=FALSE}

peopleData <- TweetsWithSentimentWithoutLink %>%
  pivot_longer(obama:amy, names_to = "person", values_to = "existenceOfPerson")

peopleData <- peopleData %>% filter(existenceOfPerson==1)

ggplot(data=peopleData, aes(x=person, fill = factor(posNeg))) +
  geom_bar(position = "fill") + 
  labs(title="Lowest proportion of Tweets with negative sentiment were Tweets
  mentioning Amy Coney Barrett and Mike Pence",
                  x="Politician",y ="Percentage of Tweets", fill="Sentiment") + 
   theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
Figure 3: Illustrates the proportion of Tweets with average negative (<0), 
neutral (=0), and positive (>0) sentiment that mention a specific politician.

```{r partyAndGender, echo=FALSE, warning=FALSE, message=FALSE}
peopleData <- peopleData %>% 
   mutate(party=case_when((person == "obama" |
               person == "biden"|
               person == "kamala" | 
               person == "pelosi" | 
               person == "aoc"|
                  person == "hillary") ~ "Democratic",
               (person == "pence" |
                   person == "amy" |
                   person == "niki" |
                  person == "mcconnell") ~ "Republican"))

peopleData <- peopleData %>% 
   mutate(gender=case_when((person=="obama" |
              person=="biden"|
               person=="pence"|
               person=="fauci"| 
               person=="mcconnell") ~ "Male",
               (person=="kamala" |
                   person=="pelosi" |
                   person=="aoc"|
                   person=="amy" |
                   person=="nikki"|
                  person=="hillary") ~ "Female"))

ggplot(data = peopleData %>% 
          filter(party=="Democratic" | party == "Republican"), 
       mapping = aes(x = party, y = ave_sentiment,color=gender)) +
   geom_boxplot() +
labs(title = "Overall more positive sentiment in Tweets mentioning Republicans",
       subtitle="Generally lower sentiment for Democratic females vs. males, 
   generally higher sentiment for Republican females vs. males",
        x = "Party", y = "Tweet Average Sentiment Score") + 
   geom_hline(yintercept=0, linetype="dashed", color = "red")
```

Figure 4: Boxplot showing the average sentiment scores for Tweets, divided by
political party of the person mentioned in the Tweet, and split within
party to show any differences in how he talks about politicians of
different genders within either the Democratic or Republican party.


```{r hypTest}
dems <- peopleData %>%
  filter(party=="Democratic")

repubs <- peopleData %>%
  filter(party=="Republican")

t.test(dems$ave_sentiment, 
       repubs$ave_sentiment,
       mu = 0,
       var.equal = FALSE,
       alternative = "less",
       conf.level = 0.95)

male <- peopleData %>%
  filter(gender=="Male")

female <- peopleData %>%
  filter(gender=="Female")

t.test(male$ave_sentiment, 
       female$ave_sentiment,
       mu = 0,
       var.equal = FALSE,
       alternative = "greater",
       conf.level = 0.95)
```



```{r topicsAcrossTime, echo=FALSE, warning=FALSE, message=FALSE}
TweetsWithSentimentDateTime <- TweetsWithSentimentWithoutLink %>%
 separate(created_at, c("date", "time"), sep = " ")

TweetsWithSentimentDateTimeFormat <- TweetsWithSentimentDateTime %>%
 mutate(date = as.Date(date, tryFormats = c("%m/%d/%y")))%>%
 pivot_longer(covid:immigration, names_to = "topic", values_to = 
                 "existenceOfTopic") %>%
 filter(existenceOfTopic == 1)

TweetsWithSentimentDateTimeFormatGroup <- TweetsWithSentimentDateTimeFormat %>%
   mutate(month = format(date, "%m"), year = format(date, "%Y")) %>%
   group_by(topic, year) %>% 
   summarize(avgSentimentForTopic = mean(ave_sentiment))

temp <- TweetsWithSentimentDateTimeFormatGroup %>% filter(topic=="climateChange"
   | topic=="news" | topic == "guns" | topic == "immigration" ) %>% 
   filter(!is.na(year))

ggplot(temp, 
       aes(x= year, y = avgSentimentForTopic, color = topic, 
           group=topic)) + theme(plot.margin = unit(c(1,0,1,0), "cm")) + 
   geom_point() + 
   geom_line() + 
   geom_vline(xintercept = "2016", linetype="dotted", 
                color = "blue", size=1.5) +
   labs(title = "Average sentiment for specific topics across the years",
       subtitle="Blue line indicates Trump's election, 
     immigration and news follow similar patterns",
   x = "Year", y = "Tweet Average Sentiment Score Per Topic", color="Topic") + 
   geom_hline(yintercept=0, linetype="dashed", color = "red")
```

Figure 5: Shows change of average sentiment of Tweets referring to a specific 
topic across the years. Only showing a few topics, we selected the ones
that have been Tweeted about for a long time. The vertical blue line indicates
when Trump first became elected.

```{r hypTest2}
yearVar <- TweetsWithSentimentDateTimeFormat  %>%
   mutate(year = year(date))

#CLIMATE CHANGE
pre2016CC <- yearVar %>%
  filter(year==2016 & topic=="climateChange")

post2016CC <- yearVar %>%
  filter(year>=2016 & topic=="climateChange")

t.test(pre2016CC$ave_sentiment, 
       post2016CC$ave_sentiment,
       mu = 0,
       var.equal = FALSE,
       alternative = "two.sided",
       conf.level = 0.95)

#GUNS 
pre2016guns <- yearVar %>%
  filter(year==2016 & topic=="guns")

post2016guns <- yearVar %>%
  filter(year>=2016 & topic=="guns")

t.test(pre2016guns$ave_sentiment, 
       post2016guns$ave_sentiment,
       mu = 0,
       var.equal = FALSE,
       alternative = "two.sided",
       conf.level = 0.95)


#IMMIGRATION 
pre2016imm <- yearVar %>%
  filter(year==2016 & topic=="immigration")

post2016imm <- yearVar %>%
  filter(year>=2016 & topic=="immigration")

t.test(pre2016imm$ave_sentiment, 
       post2016imm$ave_sentiment,
       mu = 0,
       var.equal = FALSE,
       alternative = "two.sided",
       conf.level = 0.95)


#NEWS
pre2016News <- yearVar %>%
  filter(year==2016 & topic=="news")

post2016News <- yearVar %>%
  filter(year>=2016 & topic=="news")

t.test(pre2016News$ave_sentiment, 
       post2016News$ave_sentiment,
       mu = 0,
       var.equal = FALSE,
       alternative = "two.sided",
       conf.level = 0.95)
```

### Results
(Figure 1)
The purpose of this visualization is to analyze what words are most commonly 
found in Donald Trump’s Tweet. Using a word cloud, the most common words are 
displayed with the most frequent words being displayed larger. Given the 
results, we can see that some of the words he most commonly uses are Trump, 
president, people, country, america, and time. While these words don’t 
necessarily indicate the full scope of what he discusses on his Twitter 
account, we are able to draw the conclusion that most of his Tweets are in 
regard to his role as the President of the United States. We believed it would 
be interesting to see if a common theme would develop among his most common 
words, which is partially indicated in our results. 

(Figure 3)
Figure 3 shows the relative proportions of Tweets with positive, neutral and 
negative overall sentiment that Donald Trump has shared about each of the people 
covered in our dataset. By creating a bar plot, we were able to actively compare 
the sentiments Trump tends to have towards specific people making it easier to 
visualize the results. Overall, it appears that Alexadria Ocasio-Cortez, Hillary 
Clinton, and Nancy Pelosi recieved the highest proportion of Tweets with 
negative sentiment. Amy Coney Barrett had the lowest proportion of negative 
Tweets, followed by Vice President Mike Pence. On the opposite side of the 
spectrum, Senate Majority Leader Mitch McConnell had the highest proportion of 
positive Tweets while Amy Coney Barrett, Mike Pence, and Nikki Haley also 
received a significant majority of Tweets with a positive sentiment. These 
results were particularly interesting because it shows that Trump tends to 
Tweet about people of the same party with positive sentiment more frequently 
compared to the people of the democratic party. 

(Chi Square Test)
The variable, polarization, is defined as how intense the sentiment of 
Donald Trump’s Tweet is. This hypothesis test will analyze if the polarization 
of the Tweet and the amount of reTweets are dependent or independent of each 
other. We chose to analyze this because we believed it to indicate the public’s 
response to his Tweets. We can draw the conclusion that the public reaction is 
dependent on how intense of a sentiment Trump expresses if we reject the null 
hypothesis.

We are performing a hypothesis test using a chi-square test. We are performing 
this hypothesis test at the 0.05 significance levels. 
Here are our null and alternative hypotheses: 

$H_0$: The polarization of the Tweet and the amount of reTweets are independent; 
there is no association between the two variables. 

$H_1$: The polarization of the Tweet  and the amount of reTweets are NOT 
independent; there is an association between the two variables 

Under the assumption that the null hypothesis is true, the chi-square test 
statistic follows a Chi-square distribution with degrees of freedom equal to 
39554.

The value of our test statistic, chi-square, is 41580. 

The p-value of our chi-square test was 6.949e-13, which is less than the 
significance level of 0.05. This means we reject the null hypothesis. We are 
concluding that there is sufficient evidence to suggest that the presence of 
throat pain and ASA classification are NOT independent or that there is 
sufficient evidence to suggest that there is an association between the two 
variables. More specifically, this hypothesis test shows that the amount of 
reTweets are dependent on how polarizing President Trump’s Tweets are. 


The purpose of these visualizations is to indicate the different sentiment he 
displays towards male versus female politicians. We decided to divide this into 
two visualizations by party affiliation because we believed the results could be 
skewed by differing political beliefs, and since we just wanted to learn if he 
had a different sentiment towards strictly males or females, we figured this was 
the best way to isolate the analysis of the gender variable. This visualization 
of the Democrats shows the average sentiment score among the Democratic 
politicians, showing specifically the difference in sentiment between male and 
female politicians using a box plot. This visualization shows that when Donald 
Trump discusses Democratic politicians, he has a similar sentiment towards male 
and female, which is fairly close to “neutral”. We also noticed that for this 
visualization, the male Democrats had a larger range of sentiments than the 
female Democrats. In the visualization of male and female Republicans, the 
females had a slightly higher average sentiment compared to their male 
counterparts. This could indicate that he talks about males in his party in a 
less positive manner as compared to the females. We also recognized that, again, 
the male Republicans had a larger range of sentiments than the female 
Republicans, showing that his sentiments are more likely to fluctuate when 
discussing a male in his Tweets.

(Topics over time)
The purpose of this visualization is to see if Donald Trump’s sentiments towards 
specific “hot button topics” change over time. We compiled all the Tweets into 
a line plot with time as the x-axis and average sentiment as the y-axis. By 
taking the average sentiment of each topic by year, we were able to create this 
visualization and see how his sentiments in his Tweets changed when discussing 
the topics. 
### Sources
http://www.trumptwitterarchive.com/about

https://www.journalism.org/2016/05/26/news-use-across-social-media-platforms-
2016/

https://www.realclearpolitics.com/articles/2019/09/11/numbers_show_how_trumps_
Tweets_drive_the_news_cycle_141217.html

https://en.wikipedia.org/wiki/List_of_most-followed_Twitter_accounts

https://twitter.com/realDonaldTrump?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7
Ctwgr%5Eauthor



